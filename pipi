<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä Mini App —Å –¢–∞–±–ª–∏—Ü–µ–π</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω */
        body { 
            font-family: sans-serif; 
            padding: 20px; 
            background-color: var(--tg-theme-bg-color); /* –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ü–≤–µ—Ç —Ç–µ–º—ã Telegram */
            color: var(--tg-theme-text-color);
        }
        input, button { 
            width: 100%; 
            padding: 12px; 
            margin-bottom: 15px; 
            box-sizing: border-box; 
            border: 1px solid var(--tg-theme-button-color);
            border-radius: 8px;
        }
        button {
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            cursor: pointer;
            font-weight: bold;
        }
        #result_output { 
            font-size: 1.1em; 
            margin-top: 20px; 
            padding: 10px;
            border: 1px solid var(--tg-theme-button-color);
            border-radius: 8px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ –¢–∞–±–ª–∏—Ü–µ</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ **X** (—à–∞–≥ **–∫—Ä–∞—Ç–Ω—ã–π 100**, –æ—Ç **900** –¥–æ **55000**):</p>

    <input type="number" id="input_x" placeholder="–í–≤–µ–¥–∏—Ç–µ X (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1500)" required min="900" max="55000" step="100">

    <button onclick="calculate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>

    <div id="result_output">–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞...</div>

    <script>
        // --- 1. –í–°–¢–†–û–ï–ù–ù–ê–Ø –ö–ê–†–¢–ê –î–ê–ù–ù–´–• X:Y (–ì–ï–ù–ï–†–ò–†–£–ï–¢–°–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò) ---
        // X: –æ—Ç 900 –¥–æ 55000, —à–∞–≥ 100
        // Y: –æ—Ç 2000 –¥–æ 15000, –ª–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç
        const dataMap = (function() {
            const X_MIN = 900;
            const X_MAX = 55000;
            const X_STEP = 100;
            const Y_MIN = 2000;
            const Y_MAX = 15000;
            
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –º–µ–∂–¥—É X_MIN –∏ X_MAX
            const totalIntervals = (X_MAX - X_MIN) / X_STEP; // 541
            // –†–∞–∑–º–µ—Ä —à–∞–≥–∞ –¥–ª—è Y, —á—Ç–æ–±—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—å Y_MAX
            const Y_STEP_SIZE = (Y_MAX - Y_MIN) / totalIntervals; 
            
            let map = {};
            
            for (let x = X_MIN; x <= X_MAX; x += X_STEP) {
                // –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞ X (–æ—Ç 0 –¥–æ 541)
                const i = (x - X_MIN) / X_STEP; 
                // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ Y –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ X
                const yValue = Y_MIN + i * Y_STEP_SIZE;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º X:Y, –æ–∫—Ä—É–≥–ª—è—è Y –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã
                map[x] = parseFloat(yValue.toFixed(2)); 
            }
            return map;
        })();
        // ------------------------------------------------------------------

        // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        Telegram.WebApp.ready();

        /**
         * –ù–∞—Ö–æ–¥–∏—Ç Y –ø–æ X –≤ dataMap –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—á–µ—Ç –ø–æ —Ñ–æ—Ä–º—É–ª–µ.
         */
        function calculate() {
            const x = parseInt(document.getElementById('input_x').value);
            const resultOutput = document.getElementById('result_output');

            // --- 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –í–≤–æ–¥–∞ ---
            if (isNaN(x) || x < 900 || x > 55000 || (x % 100 !== 0)) {
                resultOutput.innerHTML = 'üî¥ **–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞:**<br>–í–≤–µ–¥–∏—Ç–µ X –∫—Ä–∞—Ç–Ω–æ–µ 100, –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 900 –¥–æ 55000.';
                Telegram.WebApp.showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –≤–≤–æ–¥ X. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∏ –∫—Ä–∞—Ç–Ω–æ—Å—Ç—å.');
                return;
            }

            const y = dataMap[x];
            
            if (typeof y === 'undefined') {
                // –≠—Ç–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏, –µ—Å–ª–∏ X –∫—Ä–∞—Ç–µ–Ω 100 –∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
                resultOutput.innerHTML = `üî¥ **–û—à–∏–±–∫–∞:**<br>–ó–Ω–∞—á–µ–Ω–∏–µ X=${x} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ.`;
                Telegram.WebApp.showAlert(`–ó–Ω–∞—á–µ–Ω–∏–µ X=${x} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∞–Ω–Ω—ã—Ö.`);
                return;
            }

            // --- 4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –†–∞—Å—á–µ—Ç–∞ ---
            // –§–æ—Ä–º—É–ª–∞: R = X + 500 + (Y / 70 * 100)
            const result = x + 500 + (y / 70 * 100);

            // --- 5. –í—ã–≤–æ–¥ –†–µ–∑—É–ª—å—Ç–∞—Ç–∞ ---
            const outputText = `üü¢ **–£—Å–ø–µ—Ö!**\n\n–í–≤–µ–¥–µ–Ω–æ X: ${x}\n–ù–∞–π–¥–µ–Ω–æ Y: ${y.toFixed(2)}\n\n**–ò—Ç–æ–≥–æ–≤—ã–π –†–µ–∑—É–ª—å—Ç–∞—Ç (R): ${result.toFixed(2)}**`;
            
            resultOutput.innerHTML = outputText.replace(/\n/g, '<br>');

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –û—Å–Ω–æ–≤–Ω–æ–π –ö–Ω–æ–ø–∫–∏ Telegram
            Telegram.WebApp.MainButton.setText(`–ò—Ç–æ–≥–æ–≤—ã–π R: ${result.toFixed(2)}`);
            if (!Telegram.WebApp.MainButton.isVisible) {
                Telegram.WebApp.MainButton.show();
            }
        }
    </script>
</body>
</html>
