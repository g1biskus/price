<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä Mini App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–º—ã Telegram –¥–ª—è –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –≤–∏–¥–∞ */
        body { 
            font-family: sans-serif; 
            padding: 20px; 
            background-color: var(--tg-theme-bg-color, white);
            color: var(--tg-theme-text-color, black);
            margin: 0;
        }
        input { 
            width: 100%; 
            padding: 12px; 
            margin-bottom: 15px; 
            box-sizing: border-box; 
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            border-radius: 8px;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            color: var(--tg-theme-text-color, black);
        }
        #result_output { 
            font-size: 1.1em; 
            margin-top: 20px; 
            padding: 10px;
            border: 1px solid var(--tg-theme-button-color, blue);
            border-radius: 8px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ –¢–∞–±–ª–∏—Ü–µ</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ **X** (—à–∞–≥ **–∫—Ä–∞—Ç–Ω—ã–π 100**, –æ—Ç **900** –¥–æ **55000**):</p>

    <input type="number" id="input_x" placeholder="–í–≤–µ–¥–∏—Ç–µ X (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1500)" required min="900" max="55000" step="100">

    <div id="result_output">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **–†–∞—Å—Å—á–∏—Ç–∞—Ç—å** –≤–Ω–∏–∑—É.</div>

    <script>
        // --- 1. –í–°–¢–†–û–ï–ù–ù–ê–Ø –ö–ê–†–¢–ê –î–ê–ù–ù–´–• X:Y (–ì–ï–ù–ï–†–ê–¶–ò–Ø) ---
        const dataMap = (function() {
            const X_MIN = 900;
            const X_MAX = 55000;
            const X_STEP = 100;
            const Y_MIN = 2000;
            const Y_MAX = 15000;

            const totalIntervals = (X_MAX - X_MIN) / X_STEP;
            const Y_STEP_SIZE = (Y_MAX - Y_MIN) / totalIntervals; 

            let map = {};
            for (let x = X_MIN; x <= X_MAX; x += X_STEP) {
                const i = (x - X_MIN) / X_STEP; 
                const yValue = Y_MIN + i * Y_STEP_SIZE;
                map[x] = parseFloat(yValue.toFixed(2)); 
            }
            return map;
        })();
        // ------------------------------------------------------------------

        // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        Telegram.WebApp.ready();

        /**
         * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –û—Å–Ω–æ–≤–Ω—É—é –ö–Ω–æ–ø–∫—É Telegram (MainButton)
         */
        function setupMainButton() {
            Telegram.WebApp.MainButton.setText("–†–ê–°–°–ß–ò–¢–ê–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢");
            Telegram.WebApp.MainButton.show();
            // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é calculate –∫ –Ω–∞–∂–∞—Ç–∏—é –Ω–∞ –ì–ª–∞–≤–Ω—É—é –ö–Ω–æ–ø–∫—É
            Telegram.WebApp.MainButton.onClick(calculate);
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        setupMainButton();

        /**
         * –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞: –Ω–∞—Ö–æ–¥–∏—Ç Y –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É–ª—É.
         */
        function calculate() {
            const x = parseInt(document.getElementById('input_x').value);
            const resultOutput = document.getElementById('result_output');

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞
            if (isNaN(x) || x < 900 || x > 55000 || (x % 100 !== 0)) {
                resultOutput.innerHTML = 'üî¥ **–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞:**<br>–í–≤–µ–¥–∏—Ç–µ X –∫—Ä–∞—Ç–Ω–æ–µ 100, –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 900 –¥–æ 55000.';
                Telegram.WebApp.showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –≤–≤–æ–¥ X. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∏ –∫—Ä–∞—Ç–Ω–æ—Å—Ç—å.');
                Telegram.WebApp.MainButton.setText("–û—à–∏–±–∫–∞! –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç");
                return;
            }

            const y = dataMap[x];

            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –†–∞—Å—á–µ—Ç–∞: R = X + 500 + (Y / 70 * 100)
            const result = x + 500 + (y / 70 * 100);

            // –í—ã–≤–æ–¥ –†–µ–∑—É–ª—å—Ç–∞—Ç–∞
            const outputText = `üü¢ **–£—Å–ø–µ—Ö!**\n\n–í–≤–µ–¥–µ–Ω–æ X: ${x}\n–ù–∞–π–¥–µ–Ω–æ Y: ${y.toFixed(2)}\n\n**–ò—Ç–æ–≥–æ–≤—ã–π –†–µ–∑—É–ª—å—Ç–∞—Ç (R): ${result.toFixed(2)}**`;

            resultOutput.innerHTML = outputText.replace(/\n/g, '<br>');

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –û—Å–Ω–æ–≤–Ω–æ–π –ö–Ω–æ–ø–∫–∏ Telegram –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –ø–æ–≤—Ç–æ—Ä–∞
            Telegram.WebApp.MainButton.setText(`–ò—Ç–æ–≥–æ–≤—ã–π R: ${result.toFixed(2)}. –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞.`);
        }
    </script>
</body>
</html>
